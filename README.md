# Taski-Docker (Production Ready)

–î–æ–º–µ–Ω –ø—Ä–æ–µ–∫—Ç–∞: [https://octopusvl.duckdns.org/](https://octopusvl.duckdns.org/)

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#—Å—Ç–µ–∫-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è)
3. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (CI/CD)](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-cicd)
4. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
5. [–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã](#–ø–æ–ª–µ–∑–Ω—ã–µ-–∫–æ–º–∞–Ω–¥—ã)

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
* **Backend:** Python 3.10, Django, DRF, **Pydantic Settings** (V2)
* **Frontend:** React
* **Database:** PostgreSQL 13
* **Web Server:** Gunicorn, Nginx (Gateway)
* **DevOps:** Docker (Multi-stage builds), Docker Compose, GitHub Actions
* **Monitoring:** Telegram Bot API

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞. –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:

* **db**: –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL 13. –ù–∞—Å—Ç—Ä–æ–µ–Ω `healthcheck` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î.
* **backend**: Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Multi-stage build** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–µ—Å–∞ –æ–±—Ä–∞–∑–∞. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–±–æ—Ä–∫—É —Å—Ç–∞—Ç–∏–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–∂–∏–¥–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `netcat`.
* **frontend**: React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø–æ—Å—Ç–∞–≤–ª—è—é—â–µ–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã.
* **gateway**: Nginx-—Å–µ—Ä–≤–µ—Ä, –≤—ã—Å—Ç—É–ø–∞—é—â–∏–π –≤ —Ä–æ–ª–∏ –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (Reverse Proxy), —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –∑–∞–ø—Ä–æ—Å—ã –∏ –æ–±—Å–ª—É–∂–∏–≤–∞—é—â–∏–π —Å—Ç–∞—Ç–∏–∫—É/–º–µ–¥–∏–∞.

---

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (CI/CD)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ **GitHub Actions**. –ü—Ä–∏ –∫–∞–∂–¥–æ–º `push` –≤ –≤–µ—Ç–∫—É `main` –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1.  **Backend Tests**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º Ruff –∏ –∑–∞–ø—É—Å–∫ Django-—Ç–µ—Å—Ç–æ–≤ –≤ —Å—Ä–µ–¥–µ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î.
2.  **Frontend Tests**: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
3.  **Build & Push**: –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–æ–≤ –∏ –∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–∞ Docker Hub.
4.  **Notification 1**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—Ä–∞–∑–æ–≤.
5.  **Deploy**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `docker-compose.production.yml` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ SCP, `pull` —Å–≤–µ–∂–∏—Ö –æ–±—Ä–∞–∑–æ–≤ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã.
6.  **Health Check**: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API –ø–æ —Ä–µ–∞–ª—å–Ω–æ–º—É –¥–æ–º–µ–Ω—É —á–µ—Ä–µ–∑ `curl`.
7.  **Notification 2**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram –æ–± —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–µ–ø–ª–æ—è.



---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã Actions –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ **Settings -> Secrets and variables -> Actions**:
* `DOCKER_USERNAME`, `DOCKER_PASSWORD`
* `HOST`, `USER`, `SSH_KEY`
* `TELEGRAM_TO`, `TELEGRAM_TOKEN`

### 2. –§–∞–π–ª .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `~/taski/` –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ñ–∞–π–ª `.env`.
–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–±–ª–∞–≥–æ–¥–∞—Ä—è Pydantic V2, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
```env
# DB
DB_USER=django_user
DB_PASS=your_password
DB_NAME=django
DB_HOST=db
DB_PORT=5432

# Django
DJANGO_DEBUG=False
DJANGO_SECRET_KEY="your_secret_key"

# Server
SERVER_IP=your_server_ip
SERVER_DOMAIN=your_sever_domain

---

```
# üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

–ü—Ä–æ–µ–∫—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω, –Ω–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:

# üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è
| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
| :--- | :--- |
| **–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤** | `sudo docker compose -f docker-compose.production.yml ps` |
| **–õ–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞** | `sudo docker compose -f docker-compose.production.yml logs -f backend` |
| **–ù–∞–≥—Ä—É–∑–∫–∞ (RAM/CPU)** | `docker stats` |

# üßπ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
**–û—á–∏—Å—Ç–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Å–µ—Ç–µ–π (–æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ–µ–≤):
```bash
sudo docker image prune -af